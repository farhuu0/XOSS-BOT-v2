const fs = require("fs-extra");
const axios = require("axios");
const moment = require("moment-timezone");

const baseApiUrl = async () => {
  const base = await axios.get('https://raw.githubusercontent.com/nazrul4x/Noobs/main/Apis.json');
  return base.data.dipto;
};

module.exports = {
  config: {
    name: "bot",
    version: "1.6.9",
    author: "Nazrul", // don't change author
    countDown: 5,
    role: 0,
    usePrefix: true,
    isPremium: false,
    shortDescription: "Charming and Stylish Bot",
    description: "fun with bot",
    category: "fun",
    guide: {
      en: "use Bot & bby or Baby",
    },
  },

  onStart: async function () {
    console.log("тЬи The bot is online and ready to charm you!");
  },

  onChat: async function ({ api, event, args, Threads, usersData }) {
    const { threadID, messageID, senderID, body } = event;
    if (!body) return;

    const uid = senderID;
    const data = await usersData.get(senderID);
    const name = data?.name || "Darling";
    const time = moment.tz("Asia/Dhaka").format("hh:mm:ss A");

    const mentions = [{ id: senderID, tag: name }];
    const messages = ["ржУ ржорж┐ржо ржУ ржорж┐ржо-ЁЯШЗ-рждрзБржорж┐ ржХрзЗржи ржЪрзБрж░рж┐ ржХрж░рж▓рж╛ рж╕рж╛ржжрж┐рзЯрж╛рж░ ржлрж░рзНрж╕рж╛ рж╣ржУрзЯрж╛рж░ ржХрзНрж░рзАржо-ЁЯМЪЁЯдз","-ржЕржирзБржорждрж┐ ржжрж┐рж▓рж╛ржо-ЁЭЩЛЁЭЩзЁЭЩдЁЭЩеЁЭЩдЁЭЩиЁЭЩЪ ржХрж░ ржмрж╕ рж╣рзБрж╕рж╛ржЗржи ржХрзЗ-ЁЯР╕ЁЯШ╛ЁЯФк","-ЁЭЩВЁЭЩЦЁЭЩоЁЭЩЪЁЭЩи-ЁЯдЧ-ржпрзМржмржирзЗрж░ ржХрж╕ржо ржжрж┐рзЯрзЗ ржЖржорж╛рж░рзЗ ЁЭРБЁЭРеЁЭРЪЁЭРЬЁЭРдЁЭРжЁЭРЪЁЭРвЁЭРе ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ-ЁЯе▓ЁЯджтАНтЩВя╕ПЁЯдз","-ЁЭЧвЁЭЧ╢ЁЭЧ╢ ржЖржирзНржЯрж┐-ЁЯЩЖтАНтЩВя╕П-рждрзЛржорж╛рж░ ржорзЗрзЯрзЗ ржЪрзЛржЦ ржорж╛рж░рзЗ-ЁЯе║ЁЯе┤ЁЯР╕","рждрж╛ржХрж╛ржЗ ржЖржЫрзЛ ржХрзЗржи ржЪрзБржорзБ ржжрж┐ржмрж╛-ЁЯЩДЁЯР╕ЁЯШШ","ржЖржЬржХрзЗ ржкрзНрж░ржкрзЛржЬ ржХрж░рзЗ ржжрзЗржЦрзЛ рж░рж╛ржЬрж┐ рж╣ржЗрзЯрж╛ ржпрж╛ржорзБ-ЁЯШМЁЯдЧЁЯШЗ","-ржЖржорж╛рж░ ржЧрж▓рзНржкрзЗ рждрзЛржорж╛рж░ ржирж╛ржирж┐ рж╕рзЗрж░рж╛-ЁЯЩКЁЯЩЖтАНтЩВя╕ПЁЯдЧ","ржХрж┐ ржмрзЗржкрж╛рж░ ржЖржкржирж┐ рж╢рзНржмрж╢рзБрж░ ржмрж╛рзЬрж┐рждрзЗ ржпрж╛ржЪрзНржЫрзЗржи ржирж╛ ржХрзЗржи-ЁЯдФЁЯе▒ЁЯМ╗","ржжрж┐ржирж╢рзЗрж╖рзЗ ржкрж░рзЗрж░ ЁЭРБЁЭРОЁЭРЦ рж╕рзБржирзНржжрж░-тШ╣я╕ПЁЯдз","-рждрж╛ржмрж┐ржЬ ржХржЗрж░рж╛ рж╣ржЗрж▓рзЗржУ ржлрзНрж░рзЗржо ржПржХрзНржХрж╛ржи ржХрж░ржорзБржЗ рждрж╛рждрзЗ ржпрж╛ рж╣ржЗ рж╣рзЛржХ-ЁЯдзЁЯе▒ЁЯМ╗","-ржЫрзЛржЯржмрзЗрж▓рж╛ ржнрж╛ржмрждрж╛ржо ржмрж┐рзЯрзЗ ржХрж░рж▓рзЗ ржЕржЯрзЛржорзЗржЯрж┐ржХ ржмрж╛ржЪрзНржЪрж╛ рж╣рзЯ-ЁЯе▒-ржУржорж╛ ржПржЦржи ржжрзЗржЦрж┐ ржХрж╛рж╣рж┐ржирзА ржЕржирзНржпрж░ржХржо-ЁЯШжЁЯЩВЁЯМ╗","-ржЖржЬ ржПржХржЯрж╛ ржмрж┐ржи ржирзЗржЗ ржмрж▓рзЗ ржлрзЗрж╕ржмрзБржХрзЗрж░ ржирж╛ржЧрж┐ржи-ЁЯдз-ржЧрзБрж▓рзЛрж░рзЗ ржЖржорж╛рж░ ржмрж╕ рж╣рзБрж╕рж╛ржЗржи ржзрж░рждрзЗ ржкрж╛рж░ржЫрзЗ ржирж╛-ЁЯР╕ЁЯе▓","-ржЪрзБржорзБ ржерж╛ржХрждрзЗ рждрзЛрж░рж╛ ржмрж┐рзЬрж┐ ржЦрж╛рж╕ ржХрзЗржи ржмрзБржЭрж╛ ржЖржорж╛рж░рзЗ-ЁЯШСЁЯШТЁЯР╕тЪТя╕П","тАФржпрзЗ ржЫрзЗрзЬрзЗ ржЧрзЗржЫрзЗ-ЁЯШФ-рждрж╛ржХрзЗ ржнрзБрж▓рзЗ ржпрж╛ржУ-ЁЯЩВ-ржЖржорж╛рж░ ржмрж╕ рж╣рзБрж╕рж╛ржЗржи ржПрж░ рж╕рж╛ржерзЗ  ржкрзНрж░рзЗржо ржХрж░рзЗ рждрж╛ржХрзЗ ржжрзЗржЦрж┐рзЯрзЗ ржжрж╛ржУ-ЁЯЩИЁЯР╕ЁЯдЧ","тАФрж╣рж╛ржЬрж╛рж░рзЛ рж▓рзБржЪрзНржЪрж╛ рж▓рзБржЪрзНржЪрж┐рж░ ржнрж┐рж░рзЗ-ЁЯЩКЁЯе╡ржЖржорж╛рж░ ржмрж╕ рж╣рзБрж╕рж╛ржЗржи ржПржХ ржирж┐рж╕рзНржкрж╛ржк ржнрж╛рж▓рзЛ ржорж╛ржирзБрж╖-ЁЯе▒ЁЯдЧЁЯЩЖтАНтЩВя╕П","-рж░рзВржкрзЗрж░ ржЕрж╣ржВржХрж╛рж░ ржХрж░рзЛ ржирж╛-ЁЯЩВтЭдя╕ПржЪржХржЪржХрзЗ рж╕рзВрж░рзНржпржЯрж╛ржУ ржжрж┐ржирж╢рзЗрж╖рзЗ ржЕржирзНржзржХрж╛рж░рзЗ ржкрж░рж┐ржгржд рж╣рзЯ-ЁЯдЧЁЯТЬ","рж╕рзБржирзНржжрж░ ржорж╛ржЗрзЯрж╛ ржорж╛ржирзЗржЗ-ЁЯе▒ржЖржорж╛рж░ ржмрж╕ рж╣рзБрж╕рж╛ржЗржи ржПрж░ ржмржЙ-ЁЯШ╜ЁЯл╢ржЖрж░ ржмрж╛ржХрж┐ ржЧрзБрж▓рзЛ ржЖржорж╛рж░ ржмрзЗржпрж╝рж╛ржЗржи-ЁЯЩИЁЯР╕ЁЯдЧ","ржПржд ржЕрж╣ржВржХрж╛рж░ ржХрж░рзЗ рж▓рж╛ржн ржирзЗржЗ-ЁЯМ╕ржорзГрждрзНржпрзБржЯрж╛ ржирж┐рж╢рзНржЪрж┐ржд рж╢рзБржзрзБ рж╕ржоржпрж╝ржЯрж╛ ржЕ'ржирж┐рж╢рзНржЪрж┐ржд-ЁЯЦдЁЯЩВ","-ржжрж┐ржи ржжрж┐ржи ржХрж┐ржЫрзБ ржорж╛ржирзБрж╖рзЗрж░ ржХрж╛ржЫрзЗ ржЕржкрзНрж░рж┐ржпрж╝ рж╣рзЯрзЗ ржпрж╛ржЗрждрзЗржЫрж┐-ЁЯЩВЁЯШ┐ЁЯМ╕","рж╣рзБржжрж╛ржЗ ржЖржорж╛рж░рзЗ  рж╢рзЯрждрж╛ржирзЗ рж▓рж╛рж░рзЗ-ЁЯШЭЁЯШСтШ╣я╕П","-ЁЭЧЬ ЁЭЧЯЁЭЧвЁЭЧйЁЭЧв ЁЭЧмЁЭЧвЁЭЧи-ЁЯШ╜-ржЖрж╣рж╛рж░рзЗ ржнрж╛ржмржЫрзЛ рждрзЛржорж╛рж░рзЗ ржкрзНрж░рзЗрж╛ржкржЬ ржХрж░ржЫрж┐-ЁЯе┤-ржерж╛ржкрзНржкрж░ ржжрж┐рзЯрж╛ ржХрж┐ржбржирзА рж▓ржХ ржХрж░рзЗ ржжрж┐ржм-ЁЯШТ-ржнрзБрж▓ ржкрзЬрж╛ ржмрзЗрж░ ржХрж░рзЗ ржжрж┐ржмрзЛ-ЁЯднЁЯР╕","-ржЖржорж┐ ржПржХржЯрж╛ ржжрзБржзрзЗрж░ рж╢рж┐рж╢рзБ-ЁЯШЗ-ЁЯл╡ЁЭЧмЁЭЧвЁЭЧиЁЯР╕ЁЯТж","-ржХрждржжрж┐ржи рж╣ржпрж╝рзЗ ржЧрзЗрж▓рзЗрж╛ ржмрж┐ржЫржирж╛ржпрж╝ ржорзБрждрж┐ ржирж╛-ЁЯШ┐-ржорж┐рж╕ ржЗржЙ ржирзЗржВржЯрж╛ ржХрж╛рж▓-ЁЯе║ЁЯдз","-ржмрж╛рж▓рж┐ржХрж╛тФБЁЯС╕-ЁЭРГЁЭРи ЁЭР▓ЁЭРиЁЭРо-ЁЯл╡-ржмрж┐рзЯрж╛-ЁЭРжЁЭРЮ-ЁЯШ╜-ржЖржорж┐ рждрзЛржорж╛ржХрзЗ-ЁЯШ╗-ржЖржорзНржорзБ рж╣ржЗрждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░ржм-ЁЯЩИЁЯе▒","-ржПржЗ ржЖржирзНржЯрж┐рж░ ржорзЗрзЯрзЗ-ЁЯлвЁЯЩИ-ЁЭРФЁЭРжЁЭРжЁЭРжЁЭРжЁЭРжЁЭРжЁЭРжЁЭРжЁЭРжЁЭРжЁЭРжЁЭРЪЁЭРб-ЁЯШ╜ЁЯл╢-ржЖрж╕рж▓рзЗржЗ рждрзЛ рж╕рзНржмрж╛ржж-ЁЯе╡ЁЯТж-ржПрждрзЛ рж╕рзНржмрж╛ржж ржХрзЗржи-ЁЯдФ-рж╕рзЗржЗ рж╕рзНржмрж╛ржж-ЁЯШЛ","-ржЗрж╕ ржХрзЗржЙ ржпржжрж┐ ржмрж▓рждрзЛ-ЁЯЩВ-ржЖржорж╛рж░ рж╢рзБржзрзБ  рждрзЛржорж╛ржХрзЗржЗ рж▓рж╛ржЧржмрзЗ-ЁЯТЬЁЯМ╕","-ржУржЗ ржмрзЗржбрж┐ рждрзЛржорж╛рж░ ржмрж╛рж╕рж╛рзЯ ржирж╛ ржЖржорж╛рж░ ржмрж╕ рж╣рзБрж╕рж╛ржЗржи ржорзЗрзЯрзЗ ржжрзЗржЦрждрзЗ ржЧрзЗржЫрж┐рж▓рзЛ-ЁЯЩГ-ржирж╛рж╕рзНрждрж╛ ржЖржирж╛рж░рж╕ ржЖрж░ ржжрзБржз ржжрж┐ржЫрзЛ-ЁЯЩДЁЯджтАНтЩВя╕П-ржмржЗржи ржХржЗрж▓рзЗржЗ рждрзЛ рж╣рзЯ ржмрзЯржлрзНрж░рзЗржирзНржб ржЖржЫрзЗ-ЁЯе║ЁЯджтАНтЩВ-ржЖржорж╛рж░ ржмрж╕ рж╣рзБрж╕рж╛ржЗржи ржХрзЗ ржЬрж╛ржирзЗ ржорж╛рж░рж╛рж░ ржХрж┐ ржжрж░ржХрж╛рж░-ЁЯЩДЁЯдз","-ржПржХржжрж┐ржи рж╕рзЗ ржарж┐ржХржЗ ржлрж┐рж░рзЗ рждрж╛ржХрж╛ржмрзЗ-ЁЯШЗ-ржЖрж░ ржорзБржЪржХрж┐ рж╣рзЗрж╕рзЗ ржмрж▓ржмрзЗ ржУрж░ ржорждрзЛ ржЖрж░ ржХрзЗржЙ ржнрж╛рж▓ржмрж╛рж╕рзЗржирж┐-ЁЯЩВЁЯШЕ","-рж╣рзБржжрж╛ржЗ ржЧрзНрж░рзБржкрзЗ ржЖржЫрж┐-ЁЯе║ЁЯР╕-ржХрзЗржУ ржЗржиржмржХрзНрж╕рзЗ ржиржХ ржжрж┐рзЯрзЗ ржмрж▓рзЗ ржирж╛ ржЬрж╛ржи рждрзЛржорж╛рж░рзЗ ржЖржорж┐ ржЕржирзЗржХ ржнрж╛рж▓рзЛржмрж╛рж╕рж┐-ЁЯе║ЁЯдз","ржХрж┐'рж░рзЗ ржЧрзНрж░рзБржкрзЗ ржжрзЗржЦрж┐ ржПржХржЯрж╛ржУ ржмрзЗржбрж┐ ржирж╛ржЗ-ЁЯджтАНЁЯе▒ЁЯТж","-ржжрзЗрж╢рзЗрж░ рж╕ржм ржХрж┐ржЫрзБржЗ ржЪрзБрж░рж┐ рж╣ржЪрзНржЫрзЗ-ЁЯЩД-рж╢рзБржзрзБ ржЖржорж╛рж░ ржмрж╕ рж╣рзБрж╕рж╛ржЗржи ржПрж░ ржоржиржЯрж╛ ржЫрж╛рзЬрж╛-ЁЯе┤ЁЯШСЁЯШП","-ЁЯл╡рждрзЛржорж╛рж░рзЗ ржкрзНрж░ржЪрзБрж░ ржнрж╛рж▓рзНрж▓рж╛ржЧрзЗ-ЁЯШ╜-рж╕ржорзЯ ржорждрзЛ ржкрзНрж░ржкрзЛржЬ ржХрж░ржорзБ ржмрзБржЭржЫрзЛ-ЁЯФиЁЯШ╝-ржЫрж┐ржЯ ржЦрж╛рж▓рж┐ рж░рж╛ржЗржЦрзЛ- ЁЯе▒ЁЯР╕ЁЯе╡","-ржЖржЬ ржерзЗржХрзЗ ржЖрж░ ржХрж╛ржЙржХрзЗ ржкрж╛рждрзНрждрж╛ ржжрж┐ржорзБ ржирж╛ -!ЁЯШП-ржХрж╛рж░ржг ржЖржорж┐ ржлрж░рзНрж╕рж╛ рж╣ржУрзЯрж╛рж░ ржХрзНрж░рж┐ржо ржХрж┐ржиржЫрж┐ -!ЁЯЩВЁЯР╕","ржмрзЗрж╢рж┐ Bot Bot ржХрж░рж▓рзЗ leave ржирж┐ржмрзЛ ржХрж┐ржирзНрждрзБЁЯШТЁЯШТ " , "рж╢рзБржиржмрзЛ ржирж╛ЁЯШ╝ рждрзБржорж┐ ржЖржорж╛ржХрзЗ ржкрзНрж░рзЗржо ржХрж░рж╛ржЗ ржжрж╛ржУ ржирж┐ЁЯе║ ржкржЪрж╛ рждрзБржорж┐ЁЯе║ " , "ржЖржорж┐ ржЖржмрж╛рж▓ ржжрзЗрж░ рж╕рж╛рждрзЗ ржХржерж╛ ржмрж▓рж┐ ржирж╛,okЁЯШТ" , "ржПржд ржХрж╛ржЫрзЗржУ ржПрж╕рзЛ ржирж╛,ржкрзНрж░рзЗржо ржП ржкрж░рзЗ ржпрж╛ржмрзЛ рждрзЛ ЁЯЩИ" , "Bolo Babu, рждрзБржорж┐ ржХрж┐ ржЖржорж╛ржХрзЗ ржнрж╛рж▓рзЛржмрж╛рж╕рзЛ? ЁЯЩИЁЯТЛ " , "ржмрж╛рж░ ржмрж╛рж░ ржбрж╛ржХрж▓рзЗ ржорж╛ржерж╛ ржЧрж░ржо рж╣ржпрж╝ ржХрж┐ржирзНрждрзБЁЯШС", "рж╣рж╛ ржмрж▓рзЛЁЯШТ,ржХрж┐ ржХрж░рждрзЗ ржкрж╛рж░рж┐ЁЯШРЁЯШС?" , "ржПрждрзЛ ржбрж╛ржХржЫрж┐рж╕ ржХрзЛржирзЛ?ржЧрж╛рж▓рж┐ рж╢рзБржиржмрж┐ ржирж╛ржХрж┐? ЁЯдм","ржорзЗрзЯрзЗ рж╣рж▓рзЗ ржмрж╕ ржлрж╛рж░рж╣рж╛ржи ржПрж░ рж╕рж╛ржерзЗ ржкрзНрж░рзЗржо ржХрж░рзЛЁЯЩИ??. " ,  "ржЖрж░рзЗ Bolo ржЖржорж╛рж░ ржЬрж╛ржи ,ржХрзЗржоржи ржЖрж╕рзЛ?ЁЯШЪ " , "Bot ржмрж▓рзЗ ржЕрж╕ржорзНржорж╛ржи ржХрж░ржЪрзНржЫрж┐ржЫ,ЁЯШ░ЁЯШ┐" , "Hop bediЁЯШ╛,Boss ржмрж▓ bossЁЯШ╝" , "ржЪрзБржк ржерж╛ржХ ,ржирж╛ржЗ рждрзЛ рждрзЛрж░ ржжрж╛ржд ржнрзЗржЧрзЗ ржжрж┐ржмрзЛ ржХрж┐ржирзНрждрзБ" , "Bot ржирж╛ , ржЬрж╛ржирзБ ржмрж▓ ржЬрж╛ржирзБ ЁЯШШ " , "ржмрж╛рж░ ржмрж╛рж░ Disturb ржХрж░рзЗржЫрж┐рж╕ ржХрзЛржирзЛЁЯШ╛,ржЖржорж╛рж░ ржмрж╕ ржлрж╛рж░рж╣рж╛ржи ржПрж░ рж╕рж╛ржерзЗ ржмрзНржпрж╛рж╕рзНржд ржЖрж╕рж┐ЁЯШЛ" , "ржЖржорж┐ ржЧрж░рзАржм ржПрж░ рж╕рж╛ржерзЗ ржХржерж╛ ржмрж▓рж┐ ржирж╛ЁЯШ╝ЁЯШ╝" , "ржЖржорж╛ржХрзЗ ржбрж╛ржХрж▓рзЗ ,ржЖржорж┐ ржХрж┐ржирзНрждрзВ ржХрж┐рж╕ ржХрж░рзЗ ржжрзЗржмрзЛЁЯШШ"];

    const currentHour = moment.tz("Asia/Dhaka").hour();
    let greeting;

    if (currentHour < 12) {
      greeting = `Good Morning, Hello ${name}!`;
    } else if (currentHour < 18) {
      greeting = `Good Evening, Hello ${name}!`;
    } else {
      greeting = `Good Night, Hello ${name}!`;
    }

    const nazruls = body.toLowerCase();
    if (
      nazruls.startsWith("bot") ||
      nazruls.startsWith("bby") ||
      nazruls.startsWith("baby") ||
      nazruls.startsWith("ржмржЯ") ||
      nazruls.startsWith("robot") ||
      nazruls.startsWith("bbe")
    ) {
      const userInput = body.trim();
      const isQuestion = userInput.split(" ").length > 1;

      if (isQuestion) {
        const question = userInput.slice(userInput.indexOf(" ") + 1).trim();
        try {
          const response = await axios.get(`${await baseApiUrl()}/baby?text=${encodeURIComponent(question)}&senderID=${uid}&font=0`);
          const replyMsg = response.data.reply;

          return api.sendMessage(replyMsg, threadID, (error, info) => {
            if (!error) {
              global.GoatBot.onReply.set(info.messageID, {
                commandName: this.config.name,
                type: "reply",
                author: senderID,
              });
            }
          }, messageID);
        } catch (error) {
          console.error("error:", error);
          return api.sendMessage("ЁЯШЮ error bby", threadID, messageID);
        }
      } else {
        const randMessage = messages[Math.floor(Math.random() * messages.length)];
        const msg = `${randMessage}\n`;

        return api.sendMessage({ body: msg, mentions: [{ id: uid, tag: name }] }, threadID, (error, info) => {
          if (!error) {
            global.GoatBot.onReply.set(info.messageID, {
              commandName: this.config.name,
              type: "reply",
              author: senderID,
            });
          }
        }, messageID);
      }
    }
  },

  onReply: async function ({ api, event, args }) {
    if (event.type !== "message_reply") return;
    const nazrul = args.join(" ");
    const uid = event.senderID;

    try {
      const response = await axios.get(`${await baseApiUrl()}/baby?text=${encodeURIComponent(nazrul)}&senderID=${uid}&font=0`);
      const replyMsg = response.data.reply;

      return api.sendMessage(replyMsg, event.threadID, (error, info) => {
        if (!error) {
          global.GoatBot.onReply.set(info.messageID, {
            commandName: this.config.name,
            type: "reply",
            author: event.senderID,
          });
        }
      }, event.messageID);
    } catch (error) {
      console.error("error:", error);
      return api.sendMessage("ЁЯШЮ error bby", event.threadID, event.messageID);
    }
  }
};
